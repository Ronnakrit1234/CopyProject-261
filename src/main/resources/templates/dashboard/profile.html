<!DOCTYPE html>
<html lang="th" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>CSTU Pantip ‚Äî Profile</title>

  <!-- ‚úÖ ‡πÉ‡∏ä‡πâ CSS ‡∏à‡∏≤‡∏Å Spring Boot -->
  <link rel="stylesheet" th:href="@{/css/profile.css}">
</head>

<body class="page">
  <!-- Sidebar -->
  <aside class="sidebar sidebar--orange">
    <div class="sidebar__section">
      <a th:href="@{/dashboard}" class="logo logo--img" aria-label="CSTU Pantip">
        <img th:src="@{/dasboardSource/darkpanthip.png}" alt="CSTU Pantip logo" class="brand-img">
      </a>

      <nav class="nav">
        <a class="nav__link" th:href="@{/dashboard}"><span>üè†</span> Overview</a>
        <a class="nav__link" th:href="@{/dashboard/review}"><span>üìù</span> Write Review +</a>
        <a class="nav__link is-active" th:href="@{/dashboard/profile}"><span>üë§</span> Profile</a>
        <a class="nav__link" th:href="@{/dashboard/history}"><span>üïì</span> History</a>
      </nav>
    </div>

    <div class="sidebar__section">
      <a class="logout" href="#" id="btnLogout">Log-out</a>
    </div>
  </aside>

  <!-- Main Content -->
  <main class="main">
    <header class="toolbar">
      <div class="toolbar__left">
        <button class="btn btn--circle" onclick="window.history.back()">‚Äπ</button>
        <h1 class="title">Profile</h1>
      </div>
    </header>

    <section class="profile-wrapper">
      <div class="profile-card">
        <div class="profile-header">
          <img src="https://cdn-icons-png.flaticon.com/512/149/149071.png" alt="Avatar" class="profile-avatar" />
          <div class="profile-name">
            <h2>FirstName LastName (th)</h2>
            <p class="profile-sub">FirstName LastName (en)</p>
            <p class="profile-email">email@dome.tu.ac.th</p>
          </div>
        </div>

        <div class="profile-info">
          <div class="info-row">
            <span class="label">‡∏Ñ‡∏ì‡∏∞</span>
            <span class="value">‡∏Ñ‡∏ì‡∏∞‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡πÅ‡∏•‡∏∞‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ</span>
          </div>

          <div class="info-row">
            <span class="label">‡∏†‡∏≤‡∏Ñ‡∏ß‡∏¥‡∏ä‡∏≤</span>
            <span class="value">‡∏õ‡∏£‡∏¥‡∏ç‡∏ç‡∏≤‡∏ï‡∏£‡∏µ ‡∏†‡∏≤‡∏Ñ‡∏û‡∏¥‡πÄ‡∏®‡∏© ‡∏™‡∏≤‡∏Ç‡∏≤‡∏ß‡∏¥‡∏ä‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå</span>
          </div>

          <div class="info-row">
            <span class="label">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</span>
            <span class="value">‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</span>
          </div>

          <div class="info-row">
            <span class="label">‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢</span>
            <span class="value">‡∏ò‡∏£‡∏£‡∏°‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå (Thammasat University)</span>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- ‚úÖ Script -->
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const data = JSON.parse(localStorage.getItem("studentData") || "{}");

      // ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ login ‡πÉ‡∏´‡πâ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤ index
      if (!data.username) {
        alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡πà‡∏≠‡∏ô");
        window.location.href = "/index.html";
        return;
      }

      // ‚úÖ ‡πÉ‡∏™‡πà‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤ Profile
      document.querySelector(".profile-name h2").textContent = data.displayname_th || "‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•";
      document.querySelector(".profile-sub").textContent = data.displayname_en || "-";
      document.querySelector(".profile-email").textContent = data.email || "-";

      // ‚úÖ ‡πÉ‡∏™‡πà‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏∑‡πà‡∏ô ‡πÜ
      document.querySelector(".info-row:nth-child(1) .value").textContent = data.faculty || "-";
      document.querySelector(".info-row:nth-child(2) .value").textContent = data.department || "-";
      document.querySelector(".info-row:nth-child(3) .value").textContent = "‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô";
      document.querySelector(".info-row:nth-child(4) .value").textContent = "‡∏ò‡∏£‡∏£‡∏°‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå (Thammasat University)";

      // ‚úÖ ‡∏õ‡∏∏‡πà‡∏° Logout
      const logoutBtn = document.getElementById("btnLogout");
      if (logoutBtn) {
        logoutBtn.addEventListener("click", (e) => {
          e.preventDefault();
          if (confirm("‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?")) {
            // üîπ ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á
            localStorage.removeItem("studentData");
            localStorage.removeItem("reviewFeedback");
            localStorage.removeItem("userFeedbackRecords");
            sessionStorage.removeItem("isAdmin");

            // üîπ ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤ Login (index.html)
            window.location.href = "/index.html";
          }
        });
      }
    });
  </script>
</body>
</html>
